% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Cluster Analysis on Breakfast Cereal},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifluatex
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\title{Cluster Analysis on Breakfast Cereal}
\author{}
\date{\vspace{-2.5em}}

\begin{document}
\maketitle

\hypertarget{problem-description}{%
\section{Problem Description}\label{problem-description}}

\begin{itemize}
\tightlist
\item
  In the following Unsupervised Learning activity, we try to cluster
  various types of breakfast cereal based on their nutritional content.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{setwd}\NormalTok{(}\StringTok{"\textasciitilde{}/R\_KSU/ML/Assignment5"}\NormalTok{)}
\NormalTok{cereals\_data }\OtherTok{\textless{}{-}} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"Cereals.csv"}\NormalTok{, }\AttributeTok{header=}\NormalTok{T)}
\NormalTok{data }\OtherTok{\textless{}{-}}\NormalTok{ cereals\_data}
\FunctionTok{str}\NormalTok{(cereals\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    77 obs. of  16 variables:
##  $ name    : chr  "100%_Bran" "100%_Natural_Bran" "All-Bran" "All-Bran_with_Extra_Fiber" ...
##  $ mfr     : chr  "N" "Q" "K" "K" ...
##  $ type    : chr  "C" "C" "C" "C" ...
##  $ calories: int  70 120 70 50 110 110 110 130 90 90 ...
##  $ protein : int  4 3 4 4 2 2 2 3 2 3 ...
##  $ fat     : int  1 5 1 0 2 2 0 2 1 0 ...
##  $ sodium  : int  130 15 260 140 200 180 125 210 200 210 ...
##  $ fiber   : num  10 2 9 14 1 1.5 1 2 4 5 ...
##  $ carbo   : num  5 8 7 8 14 10.5 11 18 15 13 ...
##  $ sugars  : int  6 8 5 0 8 10 14 8 6 5 ...
##  $ potass  : int  280 135 320 330 NA 70 30 100 125 190 ...
##  $ vitamins: int  25 0 25 25 25 25 25 25 25 25 ...
##  $ shelf   : int  3 3 3 3 3 1 2 3 1 3 ...
##  $ weight  : num  1 1 1 1 1 1 1 1.33 1 1 ...
##  $ cups    : num  0.33 1 0.33 0.5 0.75 0.75 1 0.75 0.67 0.67 ...
##  $ rating  : num  68.4 34 59.4 93.7 34.4 ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(cereals\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##      name               mfr                type              calories    
##  Length:77          Length:77          Length:77          Min.   : 50.0  
##  Class :character   Class :character   Class :character   1st Qu.:100.0  
##  Mode  :character   Mode  :character   Mode  :character   Median :110.0  
##                                                           Mean   :106.9  
##                                                           3rd Qu.:110.0  
##                                                           Max.   :160.0  
##                                                                          
##     protein           fat            sodium          fiber       
##  Min.   :1.000   Min.   :0.000   Min.   :  0.0   Min.   : 0.000  
##  1st Qu.:2.000   1st Qu.:0.000   1st Qu.:130.0   1st Qu.: 1.000  
##  Median :3.000   Median :1.000   Median :180.0   Median : 2.000  
##  Mean   :2.545   Mean   :1.013   Mean   :159.7   Mean   : 2.152  
##  3rd Qu.:3.000   3rd Qu.:2.000   3rd Qu.:210.0   3rd Qu.: 3.000  
##  Max.   :6.000   Max.   :5.000   Max.   :320.0   Max.   :14.000  
##                                                                  
##      carbo          sugars           potass          vitamins     
##  Min.   : 5.0   Min.   : 0.000   Min.   : 15.00   Min.   :  0.00  
##  1st Qu.:12.0   1st Qu.: 3.000   1st Qu.: 42.50   1st Qu.: 25.00  
##  Median :14.5   Median : 7.000   Median : 90.00   Median : 25.00  
##  Mean   :14.8   Mean   : 7.026   Mean   : 98.67   Mean   : 28.25  
##  3rd Qu.:17.0   3rd Qu.:11.000   3rd Qu.:120.00   3rd Qu.: 25.00  
##  Max.   :23.0   Max.   :15.000   Max.   :330.00   Max.   :100.00  
##  NA's   :1      NA's   :1        NA's   :2                        
##      shelf           weight          cups           rating     
##  Min.   :1.000   Min.   :0.50   Min.   :0.250   Min.   :18.04  
##  1st Qu.:1.000   1st Qu.:1.00   1st Qu.:0.670   1st Qu.:33.17  
##  Median :2.000   Median :1.00   Median :0.750   Median :40.40  
##  Mean   :2.208   Mean   :1.03   Mean   :0.821   Mean   :42.67  
##  3rd Qu.:3.000   3rd Qu.:1.00   3rd Qu.:1.000   3rd Qu.:50.83  
##  Max.   :3.000   Max.   :1.50   Max.   :1.500   Max.   :93.70  
## 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(cereals\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                        name mfr type calories protein fat sodium fiber carbo
## 1                 100%_Bran   N    C       70       4   1    130  10.0   5.0
## 2         100%_Natural_Bran   Q    C      120       3   5     15   2.0   8.0
## 3                  All-Bran   K    C       70       4   1    260   9.0   7.0
## 4 All-Bran_with_Extra_Fiber   K    C       50       4   0    140  14.0   8.0
## 5            Almond_Delight   R    C      110       2   2    200   1.0  14.0
## 6   Apple_Cinnamon_Cheerios   G    C      110       2   2    180   1.5  10.5
##   sugars potass vitamins shelf weight cups   rating
## 1      6    280       25     3      1 0.33 68.40297
## 2      8    135        0     3      1 1.00 33.98368
## 3      5    320       25     3      1 0.33 59.42551
## 4      0    330       25     3      1 0.50 93.70491
## 5      8     NA       25     3      1 0.75 34.38484
## 6     10     70       25     1      1 0.75 29.50954
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{tail}\NormalTok{(cereals\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                   name mfr type calories protein fat sodium fiber carbo sugars
## 72   Total_Whole_Grain   G    C      100       3   1    200     3    16      3
## 73             Triples   G    C      110       2   1    250     0    21      3
## 74                Trix   G    C      110       1   1    140     0    13     12
## 75          Wheat_Chex   R    C      100       3   1    230     3    17      3
## 76            Wheaties   G    C      100       3   1    200     3    17      3
## 77 Wheaties_Honey_Gold   G    C      110       2   1    200     1    16      8
##    potass vitamins shelf weight cups   rating
## 72    110      100     3      1 1.00 46.65884
## 73     60       25     3      1 0.75 39.10617
## 74     25       25     2      1 1.00 27.75330
## 75    115       25     1      1 0.67 49.78744
## 76    110       25     1      1 1.00 51.59219
## 77     60       25     1      1 0.75 36.18756
\end{verbatim}

\hypertarget{data-pre-processing}{%
\section{Data Pre-Processing}\label{data-pre-processing}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Total number of NA values in the data set}
\FunctionTok{colSums}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(cereals\_data))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     name      mfr     type calories  protein      fat   sodium    fiber 
##        0        0        0        0        0        0        0        0 
##    carbo   sugars   potass vitamins    shelf   weight     cups   rating 
##        1        1        2        0        0        0        0        0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# comment: There are 4 NA values in dataset we shall remove those. }
\NormalTok{cereals\_data }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(cereals\_data)}

\CommentTok{\#check for NA values again}
\FunctionTok{colSums}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(cereals\_data))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     name      mfr     type calories  protein      fat   sodium    fiber 
##        0        0        0        0        0        0        0        0 
##    carbo   sugars   potass vitamins    shelf   weight     cups   rating 
##        0        0        0        0        0        0        0        0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Setting the rownames of the breakfast cereals to the row names, as this will later help us in visualizing the clusters.}
\NormalTok{data }\OtherTok{\textless{}{-}}\NormalTok{ cereals\_data}
\FunctionTok{rownames}\NormalTok{(cereals\_data) }\OtherTok{\textless{}{-}}\NormalTok{ cereals\_data}\SpecialCharTok{$}\NormalTok{name}
\NormalTok{cereals\_data}\SpecialCharTok{$}\NormalTok{name }\OtherTok{=} \ConstantTok{NULL}
\FunctionTok{head}\NormalTok{(cereals\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                           mfr type calories protein fat sodium fiber carbo
## 100%_Bran                   N    C       70       4   1    130  10.0   5.0
## 100%_Natural_Bran           Q    C      120       3   5     15   2.0   8.0
## All-Bran                    K    C       70       4   1    260   9.0   7.0
## All-Bran_with_Extra_Fiber   K    C       50       4   0    140  14.0   8.0
## Apple_Cinnamon_Cheerios     G    C      110       2   2    180   1.5  10.5
## Apple_Jacks                 K    C      110       2   0    125   1.0  11.0
##                           sugars potass vitamins shelf weight cups   rating
## 100%_Bran                      6    280       25     3      1 0.33 68.40297
## 100%_Natural_Bran              8    135        0     3      1 1.00 33.98368
## All-Bran                       5    320       25     3      1 0.33 59.42551
## All-Bran_with_Extra_Fiber      0    330       25     3      1 0.50 93.70491
## Apple_Cinnamon_Cheerios       10     70       25     1      1 0.75 29.50954
## Apple_Jacks                   14     30       25     2      1 1.00 33.17409
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Converting categorical variables into dummy variables }
\FunctionTok{library}\NormalTok{(fastDummies)}
\NormalTok{cereals\_data }\OtherTok{\textless{}{-}}\NormalTok{ fastDummies}\SpecialCharTok{::}\FunctionTok{dummy\_cols}\NormalTok{(cereals\_data, }\AttributeTok{select\_columns =} \StringTok{"mfr"}\NormalTok{)[,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}
\NormalTok{cereals\_data }\OtherTok{\textless{}{-}}\NormalTok{ fastDummies}\SpecialCharTok{::}\FunctionTok{dummy\_cols}\NormalTok{(cereals\_data, }\AttributeTok{select\_columns =} \StringTok{"type"}\NormalTok{)[,}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{]}
\NormalTok{cereals\_data }\OtherTok{\textless{}{-}}\NormalTok{ fastDummies}\SpecialCharTok{::}\FunctionTok{dummy\_cols}\NormalTok{(cereals\_data, }\AttributeTok{select\_columns =} \StringTok{"shelf"}\NormalTok{)[,}\SpecialCharTok{{-}}\DecValTok{10}\NormalTok{]}
\FunctionTok{str}\NormalTok{(cereals\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    74 obs. of  24 variables:
##  $ calories: int  70 120 70 50 110 110 130 90 90 120 ...
##  $ protein : int  4 3 4 4 2 2 3 2 3 1 ...
##  $ fat     : int  1 5 1 0 2 0 2 1 0 2 ...
##  $ sodium  : int  130 15 260 140 180 125 210 200 210 220 ...
##  $ fiber   : num  10 2 9 14 1.5 1 2 4 5 0 ...
##  $ carbo   : num  5 8 7 8 10.5 11 18 15 13 12 ...
##  $ sugars  : int  6 8 5 0 10 14 8 6 5 12 ...
##  $ potass  : int  280 135 320 330 70 30 100 125 190 35 ...
##  $ vitamins: int  25 0 25 25 25 25 25 25 25 25 ...
##  $ weight  : num  1 1 1 1 1 1 1.33 1 1 1 ...
##  $ cups    : num  0.33 1 0.33 0.5 0.75 1 0.75 0.67 0.67 0.75 ...
##  $ rating  : num  68.4 34 59.4 93.7 29.5 ...
##  $ mfr_A   : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ mfr_G   : int  0 0 0 0 1 0 1 0 0 0 ...
##  $ mfr_K   : int  0 0 1 1 0 1 0 0 0 0 ...
##  $ mfr_N   : int  1 0 0 0 0 0 0 0 0 0 ...
##  $ mfr_P   : int  0 0 0 0 0 0 0 0 1 0 ...
##  $ mfr_Q   : int  0 1 0 0 0 0 0 0 0 1 ...
##  $ mfr_R   : int  0 0 0 0 0 0 0 1 0 0 ...
##  $ type_C  : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ type_H  : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ shelf_1 : int  0 0 0 0 1 0 0 1 0 0 ...
##  $ shelf_2 : int  0 0 0 0 0 1 0 0 0 1 ...
##  $ shelf_3 : int  1 1 1 1 0 0 1 0 1 0 ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{rownames}\NormalTok{(cereals\_data) }\OtherTok{\textless{}{-}}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{name}
\FunctionTok{head}\NormalTok{(cereals\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                           calories protein fat sodium fiber carbo sugars potass
## 100%_Bran                       70       4   1    130  10.0   5.0      6    280
## 100%_Natural_Bran              120       3   5     15   2.0   8.0      8    135
## All-Bran                        70       4   1    260   9.0   7.0      5    320
## All-Bran_with_Extra_Fiber       50       4   0    140  14.0   8.0      0    330
## Apple_Cinnamon_Cheerios        110       2   2    180   1.5  10.5     10     70
## Apple_Jacks                    110       2   0    125   1.0  11.0     14     30
##                           vitamins weight cups   rating mfr_A mfr_G mfr_K mfr_N
## 100%_Bran                       25      1 0.33 68.40297     0     0     0     1
## 100%_Natural_Bran                0      1 1.00 33.98368     0     0     0     0
## All-Bran                        25      1 0.33 59.42551     0     0     1     0
## All-Bran_with_Extra_Fiber       25      1 0.50 93.70491     0     0     1     0
## Apple_Cinnamon_Cheerios         25      1 0.75 29.50954     0     1     0     0
## Apple_Jacks                     25      1 1.00 33.17409     0     0     1     0
##                           mfr_P mfr_Q mfr_R type_C type_H shelf_1 shelf_2
## 100%_Bran                     0     0     0      1      0       0       0
## 100%_Natural_Bran             0     1     0      1      0       0       0
## All-Bran                      0     0     0      1      0       0       0
## All-Bran_with_Extra_Fiber     0     0     0      1      0       0       0
## Apple_Cinnamon_Cheerios       0     0     0      1      0       1       0
## Apple_Jacks                   0     0     0      1      0       0       1
##                           shelf_3
## 100%_Bran                       1
## 100%_Natural_Bran               1
## All-Bran                        1
## All-Bran_with_Extra_Fiber       1
## Apple_Cinnamon_Cheerios         0
## Apple_Jacks                     0
\end{verbatim}

\hypertarget{data-normalization}{%
\section{Data Normalization}\label{data-normalization}}

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# Data Scaling }
\NormalTok{mean\_norm\_minmax }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(x)\{}
\NormalTok{                                (x}\SpecialCharTok{{-}} \FunctionTok{mean}\NormalTok{(x)) }\SpecialCharTok{/}\NormalTok{(}\FunctionTok{max}\NormalTok{(x)}\SpecialCharTok{{-}}\FunctionTok{min}\NormalTok{(x))}
\NormalTok{\}}

\NormalTok{cereals\_data }\OtherTok{\textless{}{-}} \FunctionTok{as.data.frame}\NormalTok{(}\FunctionTok{lapply}\NormalTok{(cereals\_data, mean\_norm\_minmax))}
\FunctionTok{rownames}\NormalTok{(cereals\_data) }\OtherTok{\textless{}{-}}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{name}
\CommentTok{\#cereals\_data\_norm \textless{}{-} scale(cereals\_data\_dum, center = T, scale = T)}
\FunctionTok{head}\NormalTok{(cereals\_data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                              calories    protein  fat     sodium       fiber
## 100%_Bran                 -0.33660934  0.2972973  0.0 -0.1011402  0.55888031
## 100%_Natural_Bran          0.11793612  0.0972973  0.8 -0.4605152 -0.01254826
## All-Bran                  -0.33660934  0.2972973  0.0  0.3051098  0.48745174
## All-Bran_with_Extra_Fiber -0.51842752  0.2972973 -0.2 -0.0698902  0.84459459
## Apple_Cinnamon_Cheerios    0.02702703 -0.1027027  0.2  0.0551098 -0.04826255
## Apple_Jacks                0.02702703 -0.1027027 -0.2 -0.1167652 -0.08397683
##                                carbo      sugars      potass    vitamins
## 100%_Bran                 -0.5405405 -0.07387387  0.57614758 -0.04054054
## 100%_Natural_Bran         -0.3738739  0.05945946  0.11583012 -0.29054054
## All-Bran                  -0.4294294 -0.14054054  0.70313170 -0.04054054
## All-Bran_with_Extra_Fiber -0.3738739 -0.47387387  0.73487773 -0.04054054
## Apple_Cinnamon_Cheerios   -0.2349850  0.19279279 -0.09051909 -0.04054054
## Apple_Jacks               -0.2072072  0.45945946 -0.21750322 -0.04054054
##                                weight       cups     rating       mfr_A
## 100%_Bran                 -0.03081081 -0.3932973  0.3440454 -0.01351351
## 100%_Natural_Bran         -0.03081081  0.1427027 -0.1108628 -0.01351351
## All-Bran                  -0.03081081 -0.3932973  0.2253933 -0.01351351
## All-Bran_with_Extra_Fiber -0.03081081 -0.2572973  0.6784526 -0.01351351
## Apple_Cinnamon_Cheerios   -0.03081081 -0.0572973 -0.1699960 -0.01351351
## Apple_Jacks               -0.03081081  0.1427027 -0.1215628 -0.01351351
##                                mfr_G      mfr_K       mfr_N      mfr_P
## 100%_Bran                 -0.2972973 -0.3108108  0.93243243 -0.1216216
## 100%_Natural_Bran         -0.2972973 -0.3108108 -0.06756757 -0.1216216
## All-Bran                  -0.2972973  0.6891892 -0.06756757 -0.1216216
## All-Bran_with_Extra_Fiber -0.2972973  0.6891892 -0.06756757 -0.1216216
## Apple_Cinnamon_Cheerios    0.7027027 -0.3108108 -0.06756757 -0.1216216
## Apple_Jacks               -0.2972973  0.6891892 -0.06756757 -0.1216216
##                                 mfr_Q       mfr_R     type_C      type_H
## 100%_Bran                 -0.09459459 -0.09459459 0.01351351 -0.01351351
## 100%_Natural_Bran          0.90540541 -0.09459459 0.01351351 -0.01351351
## All-Bran                  -0.09459459 -0.09459459 0.01351351 -0.01351351
## All-Bran_with_Extra_Fiber -0.09459459 -0.09459459 0.01351351 -0.01351351
## Apple_Cinnamon_Cheerios   -0.09459459 -0.09459459 0.01351351 -0.01351351
## Apple_Jacks               -0.09459459 -0.09459459 0.01351351 -0.01351351
##                              shelf_1    shelf_2   shelf_3
## 100%_Bran                 -0.2567568 -0.2702703  0.527027
## 100%_Natural_Bran         -0.2567568 -0.2702703  0.527027
## All-Bran                  -0.2567568 -0.2702703  0.527027
## All-Bran_with_Extra_Fiber -0.2567568 -0.2702703  0.527027
## Apple_Cinnamon_Cheerios    0.7432432 -0.2702703 -0.472973
## Apple_Jacks               -0.2567568  0.7297297 -0.472973
\end{verbatim}

\hypertarget{data-exploration}{%
\section{DATA EXPLORATION}\label{data-exploration}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Correlation chart avoiding the dummified variables}
\FunctionTok{library}\NormalTok{(factoextra)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: ggplot2
\end{verbatim}

\begin{verbatim}
## Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{distance }\OtherTok{\textless{}{-}} \FunctionTok{get\_dist}\NormalTok{(cereals\_data[,}\DecValTok{2}\SpecialCharTok{:}\DecValTok{13}\NormalTok{])}
\FunctionTok{fviz\_dist}\NormalTok{(distance, }\AttributeTok{gradient =} \FunctionTok{list}\NormalTok{(}\AttributeTok{low=} \StringTok{"\#00AFBB"}\NormalTok{, }\AttributeTok{mid =} \StringTok{"white"}\NormalTok{, }\AttributeTok{high =} \StringTok{"\#DC4E07"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment5_files/figure-latex/unnamed-chunk-10-1.pdf}

\hypertarget{determining-optimal-clusters}{%
\section{Determining Optimal
Clusters}\label{determining-optimal-clusters}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{fviz\_nbclust}\NormalTok{(cereals\_data, }\AttributeTok{FUN =}\NormalTok{ hcut, }\AttributeTok{method =} \StringTok{"wss"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment5_files/figure-latex/unnamed-chunk-11-1.pdf}

\begin{itemize}
\tightlist
\item
  From these estimators, lets assume the optimum K would be 2 We shall
  evaluate its stability later.
\end{itemize}

\hypertarget{hierarchical-clustering}{%
\section{Hierarchical Clustering}\label{hierarchical-clustering}}

\hypertarget{i-used-the-euclidean-distance-measure.}{%
\subsubsection{I used the euclidean distance
measure.}\label{i-used-the-euclidean-distance-measure.}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dist }\OtherTok{\textless{}{-}} \FunctionTok{dist}\NormalTok{(cereals\_data[,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{12}\NormalTok{], }\AttributeTok{method=}\StringTok{"euclidean"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  hierarchical clustering using ward linkage method.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hc\_fit\_wd }\OtherTok{\textless{}{-}} \FunctionTok{hclust}\NormalTok{(dist, }\AttributeTok{method=}\StringTok{"ward"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## The "ward" method has been renamed to "ward.D"; note new "ward.D2"
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(hc\_fit\_wd)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment5_files/figure-latex/unnamed-chunk-13-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{points\_hc }\OtherTok{\textless{}{-}} \FunctionTok{cutree}\NormalTok{(hc\_fit\_wd, }\AttributeTok{k=}\DecValTok{2}\NormalTok{)}
\NormalTok{cereals\_clusts\_hc }\OtherTok{\textless{}{-}} \FunctionTok{cbind}\NormalTok{(points\_hc, cereals\_data)}

\FunctionTok{colnames}\NormalTok{(cereals\_clusts\_hc)[}\DecValTok{1}\NormalTok{] }\OtherTok{\textless{}{-}} \StringTok{"cluster\_hc"}
\FunctionTok{head}\NormalTok{(cereals\_clusts\_hc)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                           cluster_hc    calories    protein  fat     sodium
## 100%_Bran                          1 -0.33660934  0.2972973  0.0 -0.1011402
## 100%_Natural_Bran                  1  0.11793612  0.0972973  0.8 -0.4605152
## All-Bran                           1 -0.33660934  0.2972973  0.0  0.3051098
## All-Bran_with_Extra_Fiber          1 -0.51842752  0.2972973 -0.2 -0.0698902
## Apple_Cinnamon_Cheerios            2  0.02702703 -0.1027027  0.2  0.0551098
## Apple_Jacks                        2  0.02702703 -0.1027027 -0.2 -0.1167652
##                                 fiber      carbo      sugars      potass
## 100%_Bran                  0.55888031 -0.5405405 -0.07387387  0.57614758
## 100%_Natural_Bran         -0.01254826 -0.3738739  0.05945946  0.11583012
## All-Bran                   0.48745174 -0.4294294 -0.14054054  0.70313170
## All-Bran_with_Extra_Fiber  0.84459459 -0.3738739 -0.47387387  0.73487773
## Apple_Cinnamon_Cheerios   -0.04826255 -0.2349850  0.19279279 -0.09051909
## Apple_Jacks               -0.08397683 -0.2072072  0.45945946 -0.21750322
##                              vitamins      weight       cups     rating
## 100%_Bran                 -0.04054054 -0.03081081 -0.3932973  0.3440454
## 100%_Natural_Bran         -0.29054054 -0.03081081  0.1427027 -0.1108628
## All-Bran                  -0.04054054 -0.03081081 -0.3932973  0.2253933
## All-Bran_with_Extra_Fiber -0.04054054 -0.03081081 -0.2572973  0.6784526
## Apple_Cinnamon_Cheerios   -0.04054054 -0.03081081 -0.0572973 -0.1699960
## Apple_Jacks               -0.04054054 -0.03081081  0.1427027 -0.1215628
##                                 mfr_A      mfr_G      mfr_K       mfr_N
## 100%_Bran                 -0.01351351 -0.2972973 -0.3108108  0.93243243
## 100%_Natural_Bran         -0.01351351 -0.2972973 -0.3108108 -0.06756757
## All-Bran                  -0.01351351 -0.2972973  0.6891892 -0.06756757
## All-Bran_with_Extra_Fiber -0.01351351 -0.2972973  0.6891892 -0.06756757
## Apple_Cinnamon_Cheerios   -0.01351351  0.7027027 -0.3108108 -0.06756757
## Apple_Jacks               -0.01351351 -0.2972973  0.6891892 -0.06756757
##                                mfr_P       mfr_Q       mfr_R     type_C
## 100%_Bran                 -0.1216216 -0.09459459 -0.09459459 0.01351351
## 100%_Natural_Bran         -0.1216216  0.90540541 -0.09459459 0.01351351
## All-Bran                  -0.1216216 -0.09459459 -0.09459459 0.01351351
## All-Bran_with_Extra_Fiber -0.1216216 -0.09459459 -0.09459459 0.01351351
## Apple_Cinnamon_Cheerios   -0.1216216 -0.09459459 -0.09459459 0.01351351
## Apple_Jacks               -0.1216216 -0.09459459 -0.09459459 0.01351351
##                                type_H    shelf_1    shelf_2   shelf_3
## 100%_Bran                 -0.01351351 -0.2567568 -0.2702703  0.527027
## 100%_Natural_Bran         -0.01351351 -0.2567568 -0.2702703  0.527027
## All-Bran                  -0.01351351 -0.2567568 -0.2702703  0.527027
## All-Bran_with_Extra_Fiber -0.01351351 -0.2567568 -0.2702703  0.527027
## Apple_Cinnamon_Cheerios   -0.01351351  0.7432432 -0.2702703 -0.472973
## Apple_Jacks               -0.01351351 -0.2567568  0.7297297 -0.472973
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(cluster)}
\FunctionTok{plot}\NormalTok{(hc\_fit\_wd)}
\FunctionTok{rect.hclust}\NormalTok{(hc\_fit\_wd, }\AttributeTok{k =} \DecValTok{2}\NormalTok{, }\AttributeTok{border =} \StringTok{"red"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment5_files/figure-latex/unnamed-chunk-15-1.pdf}

\hypertarget{quality-of-clusters-created}{%
\paragraph{Quality of clusters
Created}\label{quality-of-clusters-created}}

\begin{verbatim}
- The silhouette width/value is a measure of how similar an object is to its own cluster (cohesion) compared to other clusters (separation)  [i.e., intra-cluster cohesion and inter-cluster separation]
- Ranges from -1 to +1  
- Values closer to 1 means higher quality of the cluster created 
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(cluster)}
\NormalTok{dist }\OtherTok{=} \FunctionTok{daisy}\NormalTok{(}\AttributeTok{x =}\NormalTok{ cereals\_data, }\AttributeTok{metric =} \StringTok{"euclidean"}\NormalTok{)}
\NormalTok{sil\_value }\OtherTok{=} \FunctionTok{silhouette}\NormalTok{(points\_hc, }\AttributeTok{dist =}\NormalTok{ dist)}
\FunctionTok{plot}\NormalTok{(sil\_value)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment5_files/figure-latex/unnamed-chunk-16-1.pdf}

\begin{itemize}
\tightlist
\item
  Try to find the optimal number of clusters where silhouette width
  would be maximum
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{sil\_value\_hc }\OtherTok{=} \DecValTok{0}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{2}\SpecialCharTok{:}\DecValTok{20}\NormalTok{) \{}
\NormalTok{  points\_hc }\OtherTok{\textless{}{-}} \FunctionTok{cutree}\NormalTok{(hc\_fit\_wd, }\AttributeTok{k =}\NormalTok{ i)}
\NormalTok{  sil\_value\_hc[i] }\OtherTok{=} \FunctionTok{mean}\NormalTok{(}\FunctionTok{silhouette}\NormalTok{(points\_hc, }\AttributeTok{dist =}\NormalTok{ dist)[,}\DecValTok{3}\NormalTok{])}
\NormalTok{\}}
\FunctionTok{plot}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{20}\NormalTok{, sil\_value\_hc, }\AttributeTok{type =} \StringTok{"b"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"No: of Clusters"}\NormalTok{, }\AttributeTok{ylab =} \StringTok{"Silhouette Width"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment5_files/figure-latex/unnamed-chunk-17-1.pdf}

\hypertarget{cluster-stability}{%
\paragraph{Cluster Stability}\label{cluster-stability}}

\begin{itemize}
\tightlist
\item
  Clusterboot function using library(fpc)
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(fpc)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'fpc' was built under R version 4.0.5
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Input the scaled cereals\_data}
\NormalTok{hclust\_stability }\OtherTok{=} \FunctionTok{clusterboot}\NormalTok{(cereals\_data, }\AttributeTok{clustermethod=}\NormalTok{hclustCBI, }\AttributeTok{method=}\StringTok{"ward.D2"}\NormalTok{, }\AttributeTok{k=}\DecValTok{2}\NormalTok{, }\AttributeTok{count =} \ConstantTok{FALSE}\NormalTok{)}
\NormalTok{hclust\_stability}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## * Cluster stability assessment *
## Cluster method:  hclust/cutree 
## Full clustering results are given as parameter result
## of the clusterboot object, which also provides further statistics
## of the resampling results.
## Number of resampling runs:  100 
## 
## Number of clusters found in data:  2 
## 
##  Clusterwise Jaccard bootstrap (omitting multiple points) mean:
## [1] 0.9094925 0.5839674
## dissolved:
## [1]  0 43
## recovered:
## [1] 89 57
\end{verbatim}

\begin{itemize}
\tightlist
\item
  Analyze the clustering results
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{clusters }\OtherTok{=}\NormalTok{ hclust\_stability}\SpecialCharTok{$}\NormalTok{result}\SpecialCharTok{$}\NormalTok{partition }
\end{Highlighting}
\end{Shaded}

\begin{itemize}
\tightlist
\item
  What are the cluster stability values? Values \textgreater{} 0.85
  denote very stable clusters. 0.6 - 0.75 means the clusters show some
  patterns but needs to be investigated further
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Cluster stability values}
\NormalTok{hclust\_stability}\SpecialCharTok{$}\NormalTok{bootmean }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.9094925 0.5839674
\end{verbatim}

\begin{itemize}
\tightlist
\item
  How many times the different clusters were dissolved
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#Cluster dissolution rate. If maximum Jaccard coefficient \textless{} 0.5, that cluster is assumed to be dissolved. Below code shows the number of times each cluster was dissolved. The lower the value, the better.}
\NormalTok{hclust\_stability}\SpecialCharTok{$}\NormalTok{bootbrd }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1]  0 43
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ggplot2)}

\FunctionTok{ggplot}\NormalTok{(cereals\_clusts\_hc, }\FunctionTok{aes}\NormalTok{(sugars, sodium, }\AttributeTok{color=}\FunctionTok{factor}\NormalTok{(cluster\_hc))) }\SpecialCharTok{+} \FunctionTok{geom\_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\includegraphics{Assignment5_files/figure-latex/unnamed-chunk-22-1.pdf}

\end{document}
